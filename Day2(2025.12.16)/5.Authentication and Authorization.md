# Chapter3. Authentication and Authorization 

## 3-1. Configure Identity Providers

### HTPasswd ID 프로바이더
외부 시스템(LDAP, GitHub 등) 없이 OpenShift 자체적으로 사용자 ID와 비밀번호를 관리하기 위해서
OpenShift 클러스터에 HTPasswd 방식의 인증 공급자를 설정하여, 관리자가 직접 생성한 사용자 계정으로 로그인가능

HTPasswd를 설정하고 사용자를 관리하려면 먼저 클러스터 관리자 권한으로 로그인해야 함.

### OpenShift 새로 설치될 때 클러스터 관리자 권한 로그인 방법을 2가지

1. X.509 클라이언트 인증서 (kubeconfig 파일 사용):

    설치 시 생성된 kubeconfig 파일(만료되지 않는 인증서 포함)을 사용하여 oc 명령어를 실행  
    export KUBECONFIG=/path/to/kubeconfig 또는 --kubeconfig 옵션을 사용  

2. kubeadmin 가상 사용자 사용:

    설치 시 생성되는 임시 관리자 계정  
    설치 로그에 제공된 비밀번호로 oc login -u kubeadmin -p [비밀번호]를 사용하여 인증

### HTPasswd ID 프로바이더 설정 절차
X.509 클라이언트 인증서 또는 kubeadmin 가상사용자를 활용해서 클러스터 관리자 권한을 확보한 후, HTPasswd를 구성한다.

1. htpasswd 파일 생성/수정

```code
htpasswd -c -B -b /tmp/htpasswd student redhat123
```
| 옵션 | 전체 설명 | 간결 역할 | 중요 참고 |
| :--- | :--- | :--- | :--- |
| **-c** | Create | **새 파일 생성** | **주의:** 기존 파일 내용을 **모두 삭제**하고 덮어씁니다. 파일을 처음 만들 때만 사용해야 합니다. |
| **-B** | Bcrypt | **Bcrypt 암호화 방식 사용** | **권장:** 높은 보안 강도로, 최신 환경에서 사용됩니다. |
| **-b** | Batch | **비밀번호를 명령줄에서 직접 입력** | 비밀번호를 대화형 프롬프트 없이 한 줄로 처리하여 편리합니다. |


2. HTPasswd 시크릿 만들기
```code
oc create secret generic htpasswd-secret --from-file htpasswd=/tmp/htpasswd -n openshift-config
```

